# 报销神表 - 启动指南

## 📋 启动步骤（Windows系统）

### 第一步：检查Python环境
确保已安装 Python 3.9 或更高版本。

在 PowerShell 或 CMD 中运行：
```bash
python --version
```

如果显示版本号（如 `Python 3.13.5`），说明已安装。如果没有，请先安装 Python。

---

### 第二步：安装项目依赖
在项目根目录（`报销神表` 文件夹）下，打开终端运行：

```bash
pip install -r requirements.txt
```

这会安装以下依赖：
- Django（Web框架）
- Pillow（图片处理）
- openpyxl（Excel导出）
- python-docx（Word导出）
- gunicorn（生产环境服务器）

**注意**：如果安装速度慢，可以使用国内镜像：
```bash
pip install -r requirements.txt -i https://pypi.tuna.tsinghua.edu.cn/simple
```

---

### 第三步：初始化数据库（如果还没运行过）
```bash
python manage.py migrate
```

**说明**：如果看到 `db.sqlite3` 文件已存在，可以跳过此步。但运行一次也无妨，会确保数据库是最新的。

---

### 第四步：创建管理员账户（重要！）

**方法一：使用脚本创建（推荐）**
```bash
python create_admin.py
```

按提示输入：
- 管理员用户名（如：admin）
- 邮箱
- 密码
- 姓名（如：张三）
- 学号（如：2021001）
- 部门（选择：文艺部/体育部等）

**方法二：使用Django管理后台创建**
```bash
python manage.py createsuperuser
```
然后访问 http://127.0.0.1:8000/admin 登录

---

### 第五步：启动开发服务器

在项目根目录运行：
```bash
python manage.py runserver
```

或者双击 `run_server.bat` 文件（如果已创建）

---

### 第六步：访问系统

打开浏览器，访问：
```
http://127.0.0.1:8000
```

如果看到登录页面，说明启动成功！

---

## 🎯 快速启动（一键脚本）

我已经为您创建了 `run_server.bat` 文件，您可以：

1. **首次使用**：先运行一次 `python create_admin.py` 创建管理员
2. **之后每次**：直接双击 `run_server.bat` 启动服务器

---

## 🔧 常见问题

### 问题1：提示 "Django 未安装"
**解决**：运行 `pip install -r requirements.txt`

### 问题2：提示 "端口被占用"
**解决**：使用其他端口
```bash
python manage.py runserver 8001
```
然后访问 `http://127.0.0.1:8001`

### 问题3：数据库错误
**解决**：删除 `db.sqlite3` 文件，然后重新运行
```bash
python manage.py migrate
```

### 问题4：找不到模块
**解决**：确保在项目根目录（包含 `manage.py` 的文件夹）运行命令

---

## 📝 使用流程

1. **管理员登录** → 访问"用户管理" → 为其他用户分配角色
2. **普通用户注册** → 填写信息（学号、部门必填）→ 等待管理员分配角色
3. **报销负责人** → 登录后可以看到本部门的报销单，可以审核和导出

---

## 🚀 生产环境部署（云服务器）

如果要在您的 2核4G 云服务器上部署：

1. 上传项目文件到服务器
2. 安装依赖：`pip install -r requirements.txt`
3. 使用 Gunicorn 启动：
   ```bash
   gunicorn reimbursement_system.wsgi:application --bind 0.0.0.0:8000
   ```
4. 配置 Nginx 反向代理（可选）

---

## ✅ 验证启动成功

看到以下信息说明启动成功：
```
Starting development server at http://127.0.0.1:8000/
Quit the server with CTRL-BREAK.
```

现在可以打开浏览器访问了！




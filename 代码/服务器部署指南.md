# ğŸš€ æŠ¥é”€ç¥è¡¨ - æœåŠ¡å™¨éƒ¨ç½²æŒ‡å—

## ğŸ“‹ æœåŠ¡å™¨ä¿¡æ¯

| é…ç½® | å€¼ |
|------|-----|
| **IPåœ°å€** | 101.43.149.245 |
| **ç”¨æˆ·å** | ubuntu |
| **æ“ä½œç³»ç»Ÿ** | Ubuntu |
| **ç«¯å£** | 80 (HTTP) |

## ğŸ”§ éƒ¨ç½²æ­¥éª¤

### 1. è¿æ¥æœåŠ¡å™¨

```bash
ssh ubuntu@101.43.149.245
# è¾“å…¥å¯†ç : Ls1QhVgd5t6>#
```

### 2. å®‰è£…ç³»ç»Ÿä¾èµ–

```bash
# æ›´æ–°ç³»ç»Ÿ
sudo apt update && sudo apt upgrade -y

# å®‰è£…Pythonå’Œä¾èµ–
sudo apt install -y python3 python3-pip python3-venv

# å®‰è£…MySQL
sudo apt install -y mysql-server libmysqlclient-dev

# å®‰è£…Nginx
sudo apt install -y nginx

# å¯åŠ¨æœåŠ¡
sudo systemctl enable mysql nginx
sudo systemctl start mysql nginx
```

### 3. é…ç½®MySQLæ•°æ®åº“

```bash
# ç™»å½•MySQL
sudo mysql

# æ‰§è¡Œä»¥ä¸‹SQLå‘½ä»¤:
CREATE DATABASE reimbursement_db CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
CREATE USER 'reimbursement_user'@'localhost' IDENTIFIED BY 'ä½ çš„å®‰å…¨å¯†ç ';
GRANT ALL PRIVILEGES ON reimbursement_db.* TO 'reimbursement_user'@'localhost';
FLUSH PRIVILEGES;
EXIT;
```

### 4. ä¸Šä¼ é¡¹ç›®ä»£ç 

ä»æœ¬åœ°ä¸Šä¼ ä»£ç åˆ°æœåŠ¡å™¨ï¼š

```bash
# åœ¨æœ¬åœ°æ‰§è¡Œ
scp -r Week5/ä»£ç /* ubuntu@101.43.149.245:/home/ubuntu/reimbursement/
```

æˆ–è€…ä½¿ç”¨FileZillaç­‰SFTPå·¥å…·ä¸Šä¼ ã€‚

### 5. é…ç½®é¡¹ç›®

```bash
# è¿›å…¥é¡¹ç›®ç›®å½•
cd /home/ubuntu/reimbursement

# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
python3 -m venv venv
source venv/bin/activate

# å®‰è£…ä¾èµ–
pip install -r requirements.txt

# åˆ›å»ºç¯å¢ƒå˜é‡æ–‡ä»¶
cp deploy/env_example.txt .env
nano .env  # ç¼–è¾‘é…ç½®
```

ç¼–è¾‘ `.env` æ–‡ä»¶ï¼š

```
SECRET_KEY=ç”Ÿæˆä¸€ä¸ªéšæœºå¯†é’¥
DEBUG=False
USE_SQLITE=false
DB_NAME=reimbursement_db
DB_USER=reimbursement_user
DB_PASSWORD=ä½ çš„æ•°æ®åº“å¯†ç 
DB_HOST=localhost
DB_PORT=3306
```

### 6. åˆå§‹åŒ–æ•°æ®åº“

```bash
# æ•°æ®åº“è¿ç§»
python manage.py migrate

# æ”¶é›†é™æ€æ–‡ä»¶
python manage.py collectstatic --noinput

# åˆ›å»ºç®¡ç†å‘˜
python create_admin.py
```

### 7. é…ç½®Nginx

```bash
# å¤åˆ¶Nginxé…ç½®
sudo cp deploy/nginx.conf /etc/nginx/sites-available/reimbursement
sudo ln -sf /etc/nginx/sites-available/reimbursement /etc/nginx/sites-enabled/

# åˆ é™¤é»˜è®¤é…ç½®ï¼ˆå¯é€‰ï¼‰
sudo rm /etc/nginx/sites-enabled/default

# æµ‹è¯•å¹¶é‡å¯Nginx
sudo nginx -t
sudo systemctl restart nginx
```

### 8. é…ç½®systemdæœåŠ¡

```bash
# åˆ›å»ºæ—¥å¿—ç›®å½•
sudo mkdir -p /var/log/gunicorn /var/run/gunicorn
sudo chown ubuntu:ubuntu /var/log/gunicorn /var/run/gunicorn

# å¤åˆ¶æœåŠ¡æ–‡ä»¶
sudo cp deploy/reimbursement.service /etc/systemd/system/

# å¯åŠ¨æœåŠ¡
sudo systemctl daemon-reload
sudo systemctl enable reimbursement
sudo systemctl start reimbursement
```

### 9. é…ç½®é˜²ç«å¢™

```bash
# å¼€æ”¾HTTPç«¯å£
sudo ufw allow 80
sudo ufw allow 443
sudo ufw allow 22
sudo ufw enable
```

## âœ… éªŒè¯éƒ¨ç½²

1. **æ£€æŸ¥æœåŠ¡çŠ¶æ€**ï¼š
   ```bash
   sudo systemctl status reimbursement
   sudo systemctl status nginx
   ```

2. **è®¿é—®ç½‘ç«™**ï¼š
   æ‰“å¼€æµè§ˆå™¨è®¿é—® http://101.43.149.245

3. **æŸ¥çœ‹æ—¥å¿—**ï¼š
   ```bash
   # åº”ç”¨æ—¥å¿—
   sudo journalctl -u reimbursement -f
   
   # Nginxæ—¥å¿—
   sudo tail -f /var/log/nginx/reimbursement_access.log
   ```

## ğŸ”„ æ—¥å¸¸ç»´æŠ¤

### é‡å¯æœåŠ¡

```bash
sudo systemctl restart reimbursement
sudo systemctl restart nginx
```

### æ›´æ–°ä»£ç 

```bash
cd /home/ubuntu/reimbursement
source venv/bin/activate

# æ‹‰å–æœ€æ–°ä»£ç æˆ–ä¸Šä¼ æ–°ä»£ç 
# ...

# æ›´æ–°ä¾èµ–
pip install -r requirements.txt

# æ•°æ®åº“è¿ç§»
python manage.py migrate

# æ”¶é›†é™æ€æ–‡ä»¶
python manage.py collectstatic --noinput

# é‡å¯æœåŠ¡
sudo systemctl restart reimbursement
```

### æŸ¥çœ‹æ—¥å¿—

```bash
# å®æ—¶æŸ¥çœ‹åº”ç”¨æ—¥å¿—
sudo journalctl -u reimbursement -f

# æŸ¥çœ‹Nginxè®¿é—®æ—¥å¿—
sudo tail -f /var/log/nginx/reimbursement_access.log

# æŸ¥çœ‹Nginxé”™è¯¯æ—¥å¿—
sudo tail -f /var/log/nginx/reimbursement_error.log
```

## ğŸ”’ å®‰å…¨å»ºè®®

1. **ä¿®æ”¹é»˜è®¤å¯†ç **ï¼šé¦–æ¬¡ç™»å½•åç«‹å³ä¿®æ”¹æœåŠ¡å™¨å¯†ç 
2. **ä½¿ç”¨HTTPS**ï¼šé…ç½®SSLè¯ä¹¦å¯ç”¨HTTPS
3. **å®šæœŸå¤‡ä»½**ï¼šè®¾ç½®æ•°æ®åº“è‡ªåŠ¨å¤‡ä»½
4. **æ›´æ–°ç³»ç»Ÿ**ï¼šå®šæœŸè¿è¡Œ `sudo apt update && sudo apt upgrade`

## ğŸ“ å¸¸è§é—®é¢˜

### Q: ç½‘ç«™æ— æ³•è®¿é—®ï¼Ÿ

1. æ£€æŸ¥æœåŠ¡æ˜¯å¦è¿è¡Œï¼š`sudo systemctl status reimbursement`
2. æ£€æŸ¥NginxçŠ¶æ€ï¼š`sudo systemctl status nginx`
3. æ£€æŸ¥é˜²ç«å¢™ï¼š`sudo ufw status`
4. æ£€æŸ¥ç«¯å£ï¼š`sudo netstat -tlnp | grep 80`

### Q: é™æ€æ–‡ä»¶æ— æ³•åŠ è½½ï¼Ÿ

```bash
python manage.py collectstatic --noinput
sudo systemctl restart nginx
```

### Q: æ•°æ®åº“è¿æ¥å¤±è´¥ï¼Ÿ

1. æ£€æŸ¥MySQLæœåŠ¡ï¼š`sudo systemctl status mysql`
2. éªŒè¯æ•°æ®åº“é…ç½®ï¼šæ£€æŸ¥ `.env` æ–‡ä»¶ä¸­çš„æ•°æ®åº“ä¿¡æ¯
3. æµ‹è¯•è¿æ¥ï¼š`mysql -u reimbursement_user -p`

---

**æœ€åæ›´æ–°**: 2025å¹´1æœˆ

**è®¿é—®åœ°å€**: http://101.43.149.245





